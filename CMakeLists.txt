project ( GraphControl )
cmake_minimum_required (VERSION 2.6)

if ("${EXTERNALS_DIRECTORY}" STREQUAL "")
	set (EXTERNALS_DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/../../HPCC/dev/Third_party")
endif()

if (WIN32)
set ( EXECUTABLE_OUTPUT_PATH "${CMAKE_BINARY_DIR}/bin/${CMAKE_BUILD_TYPE}" )
set ( LIBRARY_OUTPUT_PATH "${CMAKE_BINARY_DIR}/bin/${CMAKE_BUILD_TYPE}" )
else (WIN32)
set ( EXECUTABLE_OUTPUT_PATH "/usr/lib/mozilla/plugins" )
set ( LIBRARY_OUTPUT_PATH "/usr/lib/mozilla/plugins" )
endif (WIN32)

find_package(Threads REQUIRED)

SET( BOOST_ROOT "${EXTERNALS_DIRECTORY}/boost" )
SET( Boost_ADDITIONAL_VERSIONS "1.44" "1.43" "1.43.0" "1.42" "1.42.0" )
SET( Boost_USE_STATIC_LIBS ON )
FIND_PACKAGE( Boost 1.44 COMPONENTS thread date_time )
IF( Boost_FOUND )
ELSE( Boost_FOUND )
    MESSAGE( "BOOST libraries were not found:  " ${BOOST_ROOT})
ENDIF( Boost_FOUND )

if (WIN32)
SET ( FREETYPE_INCLUDE_DIR_freetype2 ${EXTERNALS_DIRECTORY}/freetype2/include )
SET ( FREETYPE_INCLUDE_DIR_ft2build ${EXTERNALS_DIRECTORY}/freetype2/include )
SET ( FREETYPE_LIBRARY ${EXTERNALS_DIRECTORY}/freetype2/objs/win32/vc2008/freetype239MT.lib )
else (WIN32)
endif (WIN32)
FIND_PACKAGE( Freetype )
IF( FREETYPE_FOUND )
ELSE( FREETYPE_FOUND )
    MESSAGE( "Freetype library was not found" )
ENDIF( FREETYPE_FOUND )

if (WIN32)
	ADD_DEFINITIONS(-D_CRT_SECURE_NO_WARNINGS -FR -DFB_WIN=1 -DXP_WIN=1)
ELSE (WIN32)
	ADD_DEFINITIONS( -DFB_X11=1 -DXP_UNIX=1)
	find_package(PkgConfig)

	# GTK is required for XEmbed to work
	if (NOT GTK_INCLUDE_DIRS)
		pkg_check_modules(GTK REQUIRED gtk+-2.0)
		set (GTK_INCLUDE_DIRS ${GTK_INCLUDE_DIRS} CACHE INTERNAL "GTK include dirs")
		set (GTK_LIBRARIES ${GTK_LIBRARIES} CACHE INTERNAL "GTK include dirs")
		set (GTK_LIBRARY_DIRS ${GTK_LIBRARY_DIRS} CACHE INTERNAL "GTK include dirs")
		set (GTK_LDFLAGS ${GTK_LDFLAGS} CACHE INTERNAL "GTK include dirs")
	endif()

	SET ( gecko_defs -DXP_UNIX )
    SET ( fPIC_flag "-fPIC" )

    set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${gecko_defs} ${fPIC_flag}")
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${gecko_defs} ${fPIC_flag}")
ENDIF (WIN32)

SET_PROPERTY(GLOBAL PROPERTY USE_FOLDERS ON)

add_subdirectory (agg)
set_property(TARGET agg PROPERTY FOLDER "3rdParty")
add_subdirectory (expat)
set_property(TARGET expat PROPERTY FOLDER "3rdParty")
add_subdirectory (graphlayout)
add_subdirectory (graphdb)
add_subdirectory (graphrender)
add_subdirectory (HPCCSystemsGraphViewControl)
#add_subdirectory (test)
